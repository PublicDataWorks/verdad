# Data Lifecycle

## Data Lifecycle

The VERDAD platform transforms raw radio broadcasts into actionable, structured data through a sophisticated multi-stage pipeline. This process ensures that high volumes of audio are filtered, transcribed, and analyzed with both linguistic and cultural nuance before being presented for human review.

### 1. Ingestion and Initial Screening (Stage 1)

The lifecycle begins with continuous recording and ingestion of radio streams. Raw audio files (typically 5â€“15 minutes long) are processed to identify potential segments of interest.

*   **Process:** VERDAD uses **Gemini** (1.5 or 2.5 Flash) for rapid screening and **OpenAI Whisper** for initial transcription.
*   **Filtering:** High-recall heuristics are applied to ensure suspicious content is flagged even if the initial confidence is low.
*   **Output:** Flagged timestamps and preliminary categorization.

### 2. Audio Extraction and Contextualization (Stage 2)

Once a segment is flagged, the system isolates it to create a standalone "snippet."

*   **Clipping:** The system extracts the specific audio segment based on Stage 1 timestamps.
*   **Context Buffers:** To ensure analysts understand the surrounding conversation, the pipeline automatically includes configurable context windows (defaulting to 90 seconds before and 60 seconds after the flagged segment).
*   **Persistence:** These snippets are stored as independent entities in the database and linked to their parent audio files.

### 3. In-Depth AI Analysis (Stage 3)

The isolated snippet undergoes a deep-dive analysis using advanced multimodal LLMs. This stage generates the rich metadata used by researchers and journalists.

The resulting data follows a structured schema (defined via Pydantic models), ensuring consistency across all languages and stations.

#### Key Data Components:
*   **Bilingual Content:** Every snippet includes professional-grade transcriptions and summaries in both Spanish and English.
*   **Claim Analysis:** Specific false or misleading claims are extracted as quotes, paired with counter-evidence and a falsity score.
*   **Emotional & Rhetorical Context:** The pipeline analyzes vocal cues, intensity, and rhetorical patterns to identify the emotional tone (e.g., fear-mongering, urgency).
*   **Political Leaning:** Provides a numeric score (-1.0 to 1.0) and supporting evidence regarding the political orientation of the content.

**Example Structured Output Structure:**

```json
{
  "transcription": "...",
  "translation": "...",
  "title": { "spanish": "...", "english": "..." },
  "claims": [
    {
      "quote": "Direct quote of the claim",
      "evidence": "Evidence demonstrating falsity",
      "score": 85
    }
  ],
  "emotional_tone": [
    {
      "emotion": { "english": "Anger" },
      "intensity": 75,
      "evidence": { "vocal_cues": ["shouting", "rapid speech"] }
    }
  ]
}
```

### 4. Human-in-the-Loop Review (Stage 4)

Data generated by the AI is treated as a "draft" until reviewed. Journalists and researchers use the VERDAD front-end to interact with the data:

*   **Validation:** Reviewers upvote or downvote AI-generated labels.
*   **Custom Labeling:** Analysts can add their own labels to track emerging disinformation trends.
*   **Discussion:** Integrated commenting (powered by Liveblocks) allows for collaborative investigation of specific snippets.

### 5. Vectorization and Discovery (Stage 5)

To support long-term research and trend analysis, the final data is indexed for semantic search.

*   **Embeddings:** The `embedding` flow generates vector representations of analyzed snippets.
*   **Similarity Search:** This allows users to find similar disinformation patterns across different radio stations or time periods, even if the specific wording differs.

### 6. Notification and Export

The final stage of the lifecycle involves disseminating the findings:
*   **Collaboration Sync:** Comments and reactions are synced to a Postgres/Supabase database via webhooks.
*   **Alerting:** Real-time notifications are sent via **Slack** and **Email** (Resend) when specific snippets are flagged or mentioned in discussions.
*   **Data Access:** Structured data is made available for trustworthy journalists to support fact-checking and counter-narrative campaigns.

---

### Data Status Reference

As data moves through the lifecycle, the `status` field in the database tracks its progress:

| Status | Description |
| :--- | :--- |
| `pending` | Newly ingested audio waiting for Stage 1. |
| `processing` | Currently being handled by an active Prefect flow. |
| `completed` | Successfully analyzed and ready for human review. |
| `error` | Processing failed (error message stored in `error_message` column). |
| `reserved` | The record is currently locked by a worker to prevent duplicate processing. |
